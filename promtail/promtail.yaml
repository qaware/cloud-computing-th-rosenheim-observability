server:
  http_listen_port: 0
  grpc_listen_port: 0

positions:
  filename: /tmp/positions.yaml

clients:
  - url: "http://loki:3100/loki/api/v1/push"

scrape_configs:
  - job_name: "apache access logs"
    static_configs:
      - labels:
          host: orous
          app: apache
          type: access_log
          __path__: /home/orous/logs/webserver/access_log
    pipeline_stages:
      - regex:
          expression: >-
            ^(?P<endpoint>\S*) (?P<ip>\S*) (?P<identd>\S*) (?P<user>\S*) \[(?P<timestamp>.*)\] "(?P<request>.*)" (?P<status>\d*) (?P<size>\S*) "(?P<url>\S*)" "(?P<browser>.*)"$
      - timestamp:
          source: timestamp
          format: "02/Jan/2006:15:04:05 -0700"


  - job_name: "apache error logs"
    static_configs:
      - labels:
          host: orous
          app: apache
          type: error_log
          __path__: /home/orous/logs/webserver/error_log_apache

    pipeline_stages:
      - regex:
          expression: >-
            ^\[(?P<timestamp>.*)\] \[(?P<type>\w*)\] \[pid (?P<pid>\d*)\] (?P<module>.*): \[client (?P<client>.*)\] (?P<errorid>\w*): (?P<message>.*)$
      - timestamp:
          source: timestamp
          format: "Mon Jan 06 15:04:05 2006"
